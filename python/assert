#!/usr/bin/env python3

import os
import traceback
import sys

# Build module with -O to disable (eg, python -O $file)
print(f"debug = {__debug__}", end='')  # Can be modified with -O
if __debug__:
    print("  assertions are enabled")
else:
    print("  assertions are disabled")

# Can also disable assertions like:
if len(sys.argv) > 1 and sys.argv[1] == 'nodebug':
    os.environ['PYTHONOPTIMIZE'] = '1'
    del sys.argv[1]
    python = sys.executable
    os.execl(python, python, *sys.argv)

# Assert will either "raise AssertionError" or
# raise "AssertionError(expression2)"

try:
    if len(sys.argv) > 1:
        assert False, sys.argv[1]
    else:
        assert False
except AssertionError as e:
    print("caught:", e.__repr__())
    print("with traceback:", e.__traceback__)
    print(f'traceback dir = {dir(e.__traceback__)}')
    print(f'extract gives: {traceback.extract_tb(e.__traceback__)}')
    print(f'e = {e}')
else:
    print('No assertions raised')  #  Happens when -O is applied
